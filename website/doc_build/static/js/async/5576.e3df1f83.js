"use strict";(self.webpackChunkelectron_rspack_website=self.webpackChunkelectron_rspack_website||[]).push([["5576"],{3286:function(e,n,r){r.r(n),r.d(n,{default:function(){return o}});var s=r(651),i=r(6971);function t(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",code:"code",h3:"h3",ul:"ul",li:"li",strong:"strong",pre:"pre",blockquote:"blockquote",ol:"ol"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"rsbuild-instance",children:["Rsbuild Instance",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuild-instance",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"This section describes all the properties and methods on the Rsbuild instance object."}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildcontext",children:["rsbuild.context",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildcontext",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"rsbuild.context"})," is a read-only object that provides some context infos."]}),"\n",(0,s.jsxs)(n.h3,{id:"contextversion",children:["context.version",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#contextversion",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The version of ",(0,s.jsx)(n.code,{children:"@rsbuild/core"})," currently in use."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Version = string;\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"contextrootpath",children:["context.rootPath",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#contextrootpath",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The root path of current build, corresponding to the ",(0,s.jsx)(n.code,{children:"cwd"})," option of ",(0,s.jsx)(n.a,{href:"/api/javascript-api/core#creatersbuild",children:"createRsbuild"})," method."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type RootPath = string;\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"contextdistpath",children:["context.distPath",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#contextdistpath",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The absolute path of the output directory, corresponding to the ",(0,s.jsx)(n.a,{href:"/config/output/dist-path",children:"output.distPath.root"})," config in ",(0,s.jsx)(n.code,{children:"RsbuildConfig"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["When there are multiple environments, Rsbuild will try to get the parent distPath of all environments as ",(0,s.jsx)(n.code,{children:"context.distPath"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If you want to get the absolute path to the output directory of a specified environment, it is recommended to use ",(0,s.jsx)(n.a,{href:"/api/javascript-api/environment-context#distpath",children:"environment.distPath"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type DistPath = string;\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"contextcachepath",children:["context.cachePath",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#contextcachepath",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"The absolute path of the build cache files."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type CachePath = string;\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"contextdevserver",children:["context.devServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#contextdevserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Dev server information, including the current dev server hostname and port number."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type DevServer = {\n  hostname: string;\n  port: number;\n};\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"contextbundlertype",children:["context.bundlerType",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#contextbundlertype",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"The bundler type of current build."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type bundlerType = 'rspack' | 'webpack';\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Rsbuild internally supports switching to webpack for comparative testing, so this field is provided for differentiation. Usually, you do not need to use this field."}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildbuild",children:["rsbuild.build",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildbuild",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Perform a production mode build."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type BuildOptions = {\n  /**\n   * Whether to watch for file changes and rebuild.\n   * @default false\n   */\n  watch?: boolean;\n  /**\n   * Using a custom Rspack Compiler object.\n   */\n  compiler?: Compiler | MultiCompiler;\n};\n\nfunction Build(options?: BuildOptions): Promise<{\n  /**\n   * Rspack's [stats](https://rspack.dev/api/javascript-api/stats) object.\n   */\n  stats?: Rspack.Stats | Rspack.MultiStats;\n  /**\n   * Stop watching when in watch mode.\n   */\n  close: () => Promise<void>;\n}>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { logger } from '@rsbuild/core';\n\n// Example 1: run build\nawait rsbuild.build();\n\n// Example 2: build and handle the error\ntry {\n  await rsbuild.build();\n} catch (err) {\n  logger.error('Failed to build.');\n  logger.error(err);\n  process.exit(1);\n}\n\n// Example 3: build and get all stats\nconst { stats } = await rsbuild.build();\n\nif (stats) {\n  const { assets } = stats.toJson({ assets: true });\n  console.log(assets);\n}\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"monitor-file-changes",children:["Monitor file changes",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#monitor-file-changes",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["If you need to watch file changes and re-build, you can set the ",(0,s.jsx)(n.code,{children:"watch"})," option to ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"await rsbuild.build({\n  watch: true,\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In watch mode, the ",(0,s.jsx)(n.code,{children:"rsbuild.build()"})," returns a ",(0,s.jsx)(n.code,{children:"close"})," method, which can be used to stop watching:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const result = await rsbuild.build({\n  watch: true,\n});\n\nawait result.close();\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"stats-object",children:["Stats Object",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#stats-object",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In non-watch mode, the `rsbuild.build() returns an Rspack ",(0,s.jsx)(n.a,{href:"https://rspack.dev/api/javascript-api/stats",target:"_blank",rel:"noopener noreferrer",children:"stats"})," object:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const result = await rsbuild.build();\n\nconsole.log(result.stats);\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"custom-compiler",children:["Custom Compiler",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#custom-compiler",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"In some cases, you may want to use a custom compiler:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { rspack } from '@rsbuild/core';\n\nconst compiler = rspack({\n  // ...\n});\nawait rsbuild.build({\n  compiler,\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildstartdevserver",children:["rsbuild.startDevServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildstartdevserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Start the local dev server."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type StartDevServerOptions = {\n  /**\n   * Using a custom Rspack Compiler object.\n   */\n  compiler?: Compiler | MultiCompiler;\n  /**\n   * Whether to get port silently and not print any logs.\n   * @default false\n   */\n  getPortSilently?: boolean;\n};\n\ntype StartServerResult = {\n  urls: string[];\n  port: number;\n  server: Server;\n};\n\nfunction StartDevServer(\n  options?: StartDevServerOptions,\n): Promise<StartServerResult>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Start dev server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { logger } from '@rsbuild/core';\n\n// Start dev server\nawait rsbuild.startDevServer();\n\n// Start dev server and handle the error\ntry {\n  await rsbuild.startDevServer();\n} catch (err) {\n  logger.error('Failed to start dev server.');\n  logger.error(err);\n  process.exit(1);\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"After successfully starting dev server, you can see the following logs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"  ➜ Local:    http://localhost:3000\n  ➜ Network:  http://192.168.0.1:3000\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"startDevServer"})," returns the following parameters:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"urls"}),": URLs to access dev server."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"port"}),": The actual listening port number."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server"}),": Server instance object."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { urls, port, server } = await rsbuild.startDevServer();\nconsole.log(urls); // ['http://localhost:3000', 'http://192.168.0.1:3000']\nconsole.log(port); // 3000\n\n// Close the dev server\nawait server.close();\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"custom-compiler-1",children:["Custom Compiler",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#custom-compiler-1",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"In some cases, you may want to use a custom compiler:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { rspack } from '@rsbuild/core';\n\nconst compiler = rspack({\n  // ...\n});\nawait rsbuild.startDevServer({\n  compiler,\n});\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"get-port-silently",children:["Get Port Silently",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#get-port-silently",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In some cases, the default startup port number is already occupied. In this situation, Rsbuild will automatically increment the port number until it finds an available one. This process will output a prompt log. If you do not want this log, you can set ",(0,s.jsx)(n.code,{children:"getPortSilently"})," to ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"await rsbuild.startDevServer({\n  getPortSilently: true,\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildcreatedevserver",children:["rsbuild.createDevServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildcreatedevserver",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Rsbuild comes with a built-in dev server designed to improve the development experience. When you run the ",(0,s.jsx)(n.code,{children:"rsbuild dev"})," command, the server will start, providing features such as page preview, routing, and hot module reloading."]}),"\n",(0,s.jsx)(n.p,{children:"If you want to integrate Rsbuild dev server into an custom server, you can use this method to get the instance methods of dev server and call them on demand."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type EnvironmentAPI = {\n  [name: string]: {\n    /**\n     * Get stats info about current environment.\n     */\n    getStats: () => Promise<Stats>;\n    /**\n     * Load and execute stats bundle in server.\n     *\n     * @param entryName - relate to Rsbuild's `source.entry`\n     * @returns the return value of entry module.\n     */\n    loadBundle: <T = unknown>(entryName: string) => Promise<T>;\n    /**\n     * Get the compiled HTML template.\n     */\n    getTransformedHtml: (entryName: string) => Promise<string>;\n  };\n};\n\ntype RsbuildDevServer = {\n  /**\n   * Listen the Rsbuild server.\n   * Do not call this method if you are using a custom server.\n   */\n  listen: () => Promise<{\n    port: number;\n    urls: string[];\n    server: {\n      close: () => Promise<void>;\n    };\n  }>;\n  /**\n   * Environment API of Rsbuild server.\n   */\n  environments: EnvironmentAPI;\n  /**\n   * The resolved port.\n   * By default, Rsbuild server listens on port `3000` and automatically increments the port number if the port is occupied.\n   */\n  port: number;\n  /**\n   * The `connect` app instance.\n   * Can be used to attach custom middlewares to the dev server.\n   */\n  middlewares: Connect.Server;\n  /**\n   * Notify that the Rsbuild server has been started.\n   * Rsbuild will trigger `onAfterStartDevServer` hook in this stage.\n   */\n  afterListen: () => Promise<void>;\n  /**\n   * Activate socket connection.\n   * This ensures that HMR works properly.\n   */\n  connectWebSocket: (options: { server: HTTPServer }) => void;\n  /**\n   * Close the Rsbuild server.\n   */\n  close: () => Promise<void>;\n  /**\n   * Print the server URLs.\n   */\n  printUrls: () => void;\n  /**\n   * Open URL in the browser after starting the server.\n   */\n  open: () => Promise<void>;\n};\n\ntype CreateDevServerOptions = {\n  /**\n   * Using a custom Rspack Compiler object.\n   */\n  compiler?: Compiler | MultiCompiler;\n  /**\n   * Whether to get port silently and not print any logs.\n   * @default false\n   */\n  getPortSilently?: boolean;\n  /**\n   * Whether to trigger Rsbuild compilation\n   * @default true\n   */\n  runCompile?: boolean;\n};\n\nfunction CreateDevServer(\n  options?: CreateDevServerOptions,\n): Promise<RsbuildDevServer>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Here is an example with ",(0,s.jsx)(n.a,{href:"https://expressjs.com/",target:"_blank",rel:"noopener noreferrer",children:"express"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createRsbuild } from '@rsbuild/core';\nimport express from 'express';\n\nexport async function startDevServer() {\n  // Init Rsbuild\n  const rsbuild = await createRsbuild({});\n\n  const app = express();\n\n  // Create Rsbuild DevServer instance\n  const rsbuildServer = await rsbuild.createDevServer();\n\n  // Apply Rsbuild’s built-in middlewares\n  app.use(rsbuildServer.middlewares);\n\n  const httpServer = app.listen(rsbuildServer.port, async () => {\n    // Notify Rsbuild that the custom server has started\n    await rsbuildServer.afterListen();\n  });\n\n  rsbuildServer.connectWebSocket({ server: httpServer });\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For detailed usage, please refer to: ",(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rspack-examples/blob/main/rsbuild/express/server.mjs",target:"_blank",rel:"noopener noreferrer",children:"Example"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If you want to use Rsbuild DevServer to start the project directly, you can use the ",(0,s.jsx)(n.a,{href:"#rsbuildstartdevserver",children:"Rsbuild - startDevServer"})," method directly. ",(0,s.jsx)(n.code,{children:"startDevServer"})," is actually syntactic sugar for the following code:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const server = await rsbuild.createDevServer();\n\nawait server.listen();\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"connectwebsocket",children:["connectWebSocket",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#connectwebsocket",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Rsbuild has a builtin WebSocket handler to support HMR:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"When a user accesses a page through browser, a WebSocket connection request is automatically initiated to the server."}),"\n",(0,s.jsx)(n.li,{children:"After the Rsbuild dev server detects the connection request, it instructs the builtin WebSocket handler to process it."}),"\n",(0,s.jsx)(n.li,{children:"After the browser successfully establishes a connection with the Rsbuild WebSocket handler, real-time communication is possible."}),"\n",(0,s.jsxs)(n.li,{children:["The Rsbuild WebSocket handler notifies the browser after each recompilation is complete. The browser then sends a ",(0,s.jsx)(n.code,{children:"hot-update.(js|json)"})," request to the dev server to load the new compiled module."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"When you use custom server, you may encounter HMR connection error problems. This is because the custom server does not forward WebSocket connection requests to Rsbuild's WebSocket handler."}),"\n",(0,s.jsxs)(n.p,{children:["At this time, you need to use the ",(0,s.jsx)(n.code,{children:"connectWebSocket"})," method to enable Rsbuild to sense and process the WebSocket connection request from the browser."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const rsbuildServer = await rsbuild.createDevServer();\n\nconst httpServer = app.listen(rsbuildServer.port);\n\nrsbuildServer.connectWebSocket({ server: httpServer });\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildpreview",children:["rsbuild.preview",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildpreview",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Start a server to preview the production build locally. This method should be executed after ",(0,s.jsx)(n.a,{href:"#rsbuildbuild",children:"rsbuild.build"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type PreviewOptions = {\n  /**\n   * Whether to get port silently\n   * @default false\n   */\n  getPortSilently?: boolean;\n  /**\n   * Whether to check if the dist directory exists and is not empty.\n   * @default true\n   */\n  checkDistDir?: boolean;\n};\n\ntype StartServerResult = {\n  urls: string[];\n  port: number;\n  server: {\n    close: () => Promise<void>;\n  };\n};\n\nfunction preview(options?: PreviewOptions): Promise<StartServerResult>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Start the server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { logger } from '@rsbuild/core';\n\n// Start preview server\nawait rsbuild.preview();\n\n// Start preview server and handle the error\ntry {\n  await rsbuild.preview();\n} catch (err) {\n  logger.error('Failed to start preview server.');\n  logger.error(err);\n  process.exit(1);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"preview"})," returns the following parameters:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"urls"}),": URLs to access server."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"port"}),": The actual listening port number."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server"}),": Server instance object."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { urls, port, server } = await rsbuild.preview();\nconsole.log(urls); // ['http://localhost:3000', 'http://192.168.0.1:3000']\nconsole.log(port); // 3000\n\n// Close the server\nawait server.close();\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildcreatecompiler",children:["rsbuild.createCompiler",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildcreatecompiler",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Create an Rspack ",(0,s.jsx)(n.a,{href:"https://rspack.dev/api/javascript-api/compiler",target:"_blank",rel:"noopener noreferrer",children:"Compiler"})," instance. If there are multiple ",(0,s.jsx)(n.a,{href:"/config/environments",children:"environments"})," for this build, the return value is ",(0,s.jsx)(n.code,{children:"MultiCompiler"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function CreateCompiler(): Promise<Compiler | MultiCompiler>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const compiler = await rsbuild.createCompiler();\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"You do not need to use this API unless you need to custom the dev server or other advanced scenarios."}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildaddplugins",children:["rsbuild.addPlugins",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildaddplugins",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Register one or more Rsbuild plugins, which can be called multiple times."}),"\n",(0,s.jsx)(n.p,{children:"This method needs to be called before compiling. If it is called after compiling, it will not affect the compilation result."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type AddPluginsOptions = { before?: string } | { after?: string };\n\nfunction AddPlugins(\n  plugins: Array<RsbuildPlugin | Falsy>,\n  options?: AddPluginsOptions,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.addPlugins([pluginFoo(), pluginBar()]);\n\n// Insert before the bar plugin\nrsbuild.addPlugins([pluginFoo()], { before: 'bar' });\n\n// Insert after the bar plugin\nrsbuild.addPlugins([pluginFoo()], { after: 'bar' });\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildgetplugins",children:["rsbuild.getPlugins",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildgetplugins",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Get all the Rsbuild plugins registered in the current Rsbuild instance."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function GetPlugins(): RsbuildPlugin[];\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.log(rsbuild.getPlugins());\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildremoveplugins",children:["rsbuild.removePlugins",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildremoveplugins",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Removes one or more Rsbuild plugins, which can be called multiple times."}),"\n",(0,s.jsx)(n.p,{children:"This method needs to be called before compiling. If it is called after compiling, it will not affect the compilation result."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function RemovePlugins(pluginNames: string[]): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// add plugin\nconst pluginFoo = pluginFoo();\nrsbuild.addPlugins(pluginFoo);\n\n// remove plugin\nrsbuild.removePlugins([pluginFoo.name]);\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildispluginexists",children:["rsbuild.isPluginExists",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildispluginexists",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Determines whether a plugin has been registered."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function IsPluginExists(pluginName: string): boolean;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.addPlugins([pluginFoo()]);\n\nrsbuild.isPluginExists(pluginFoo().name); // true\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildinitconfigs",children:["rsbuild.initConfigs",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildinitconfigs",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"The initConfigs method is used to initialize the internal configs of Rsbuild and return the Rspack config generated internally by Rsbuild."}),"\n",(0,s.jsxs)(n.p,{children:["Usually, you do not need to call the initConfigs method, because it will be automatically called when methods such as ",(0,s.jsx)(n.a,{href:"#rsbuildbuild",children:"rsbuild.build"}),", ",(0,s.jsx)(n.a,{href:"#rsbuildstartdevserver",children:"rsbuild.startDevServer"})," are called."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function InitConfigs(): Promise<{\n  rspackConfigs: Rspack.Configuration[];\n}>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { rspackConfigs } = await rsbuild.initConfigs();\n\nconsole.log(rspackConfigs);\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildinspectconfig",children:["rsbuild.inspectConfig",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildinspectconfig",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"The inspectConfig method is typically used for debugging the internal configuration of Rsbuild. It returns the internally generated Rsbuild config and Rspack config, serializes them into strings, and supports writing them to the disk."}),"\n",(0,s.jsxs)(n.p,{children:["If you need to view the Rsbuild and Rspack configurations during the build process, you can use ",(0,s.jsx)(n.a,{href:"/guide/debug/debug-mode",children:"debug mode"}),", or obtain them through hooks such as ",(0,s.jsx)(n.a,{href:"#rsbuildonbeforebuild",children:"onBeforeBuild"}),", ",(0,s.jsx)(n.a,{href:"#rsbuildonbeforecreatecompiler",children:"onBeforeCreateCompile"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'type InspectConfigOptions = {\n  // View the config in the specified environment\n  // defaults to "development", can be set to "production"\n  mode?: RsbuildMode;\n  // Whether to enable verbose mode, display the complete content of the function in the config\n  // defaults to `false`\n  verbose?: boolean;\n  // Specify the output path\n  // defaults to the value of `output.distPath.root`\n  outputPath?: string;\n  // Whether to write the result to disk\n  // defaults to `false`\n  writeToDisk?: boolean;\n};\n\nasync function InspectConfig(options?: InspectConfigOptions): Promise<{\n  rsbuildConfig: string;\n  bundlerConfigs: string[];\n  environmentConfigs: string[];\n  origin: {\n    rsbuildConfig: RsbuildConfig;\n    environmentConfigs: Record<string, EnvironmentConfig>;\n    bundlerConfigs: BundlerConfigs[];\n  };\n}>;\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"example",children:["Example",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#example",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Get the content of configs in string format:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { rsbuildConfig, bundlerConfigs } = await rsbuild.inspectConfig();\n\nconsole.log(rsbuildConfig, bundlerConfigs);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Write the config content to disk:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"await rsbuild.inspectConfig({\n  writeToDisk: true,\n});\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"output-path",children:["Output Path",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#output-path",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["You can set the output path using ",(0,s.jsx)(n.code,{children:"outputPath"}),". The default value is ",(0,s.jsx)(n.a,{href:"/config/output/dist-path",children:"output.distPath.root"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"outputPath"})," is a relative path, it will be concatenated relative to the value of ",(0,s.jsx)(n.code,{children:"output.distPath.root"}),". You can also set ",(0,s.jsx)(n.code,{children:"outputPath"})," to an absolute path, in which case the files will be written directly to that path. For example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import path from 'node:path';\n\nawait rsbuild.inspectConfig({\n  writeToDisk: true,\n  outputPath: path.join(__dirname, 'custom-dir'),\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonbeforecreatecompiler",children:["rsbuild.onBeforeCreateCompiler",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonbeforecreatecompiler",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"onBeforeCreateCompiler"})," is a callback function that is triggered after the Compiler instance has been created, but before the build process begins. This hook is called when you run ",(0,s.jsx)(n.code,{children:"rsbuild.startDevServer"}),", ",(0,s.jsx)(n.code,{children:"rsbuild.build"}),", or ",(0,s.jsx)(n.code,{children:"rsbuild.createCompiler"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["You can access the Rspack configuration array through the ",(0,s.jsx)(n.code,{children:"bundlerConfigs"})," parameter. The array may contain one or more ",(0,s.jsx)(n.a,{href:"https://rspack.dev/config/",target:"_blank",rel:"noopener noreferrer",children:"Rspack configurations"}),". It depends on whether multiple ",(0,s.jsx)(n.a,{href:"/config/environments",children:"environments"})," are configured."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: Rspack.Configuration[];\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n  console.log('the Rspack config is ', bundlerConfigs);\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonaftercreatecompiler",children:["rsbuild.onAfterCreateCompiler",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonaftercreatecompiler",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"onAfterCreateCompiler"})," is a callback function that is triggered after the compiler instance has been created, but before the build process. This hook is called when you run ",(0,s.jsx)(n.code,{children:"rsbuild.startDevServer"}),", ",(0,s.jsx)(n.code,{children:"rsbuild.build"}),", or ",(0,s.jsx)(n.code,{children:"rsbuild.createCompiler"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["You can access the ",(0,s.jsx)(n.a,{href:"https://rspack.dev/api/javascript-api/compiler",target:"_blank",rel:"noopener noreferrer",children:"Compiler instance"})," through the ",(0,s.jsx)(n.code,{children:"compiler"})," parameter:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n  environments: Record<string, EnvironmentContext>;\n}) => Promise<void> | void;): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onAfterCreateCompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonbeforebuild",children:["rsbuild.onBeforeBuild",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonbeforebuild",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"onBeforeBuild"})," is a callback function that is triggered before the production build is executed."]}),"\n",(0,s.jsxs)(n.p,{children:["You can access the Rspack configuration array through the ",(0,s.jsx)(n.code,{children:"bundlerConfigs"})," parameter. The array may contain one or more ",(0,s.jsx)(n.a,{href:"https://rspack.dev/config/",target:"_blank",rel:"noopener noreferrer",children:"Rspack configurations"}),". It depends on whether multiple ",(0,s.jsx)(n.a,{href:"/config/environments",children:"environments"})," are configured."]}),"\n",(0,s.jsxs)(n.p,{children:["Moreover, you can use ",(0,s.jsx)(n.code,{children:"isWatch"})," to determine whether it is watch mode, and use ",(0,s.jsx)(n.code,{children:"isFirstCompile"})," to determine whether it is the first build on watch mode."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnBeforeBuild(\n  callback: (params: {\n    isWatch: boolean;\n    isFirstCompile: boolean;\n    bundlerConfigs?: Rspack.Configuration[];\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onBeforeBuild(({ bundlerConfigs }) => {\n  console.log('the Rspack config is ', bundlerConfigs);\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonafterbuild",children:["rsbuild.onAfterBuild",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonafterbuild",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"onAfterBuild"})," is a callback function that is triggered after running the production build. You can access the build result information via the ",(0,s.jsx)(n.a,{href:"https://rspack.dev/api/javascript-api/stats",target:"_blank",rel:"noopener noreferrer",children:"stats"})," parameter."]}),"\n",(0,s.jsxs)(n.p,{children:["Moreover, you can use ",(0,s.jsx)(n.code,{children:"isWatch"})," to determine whether it is watch mode, and use ",(0,s.jsx)(n.code,{children:"isFirstCompile"})," to determine whether it is the first build on watch mode."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnAfterBuild(\n  callback: (params: {\n    isFirstCompile: boolean;\n    isWatch: boolean;\n    stats?: Stats | MultiStats;\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onAfterBuild(({ stats }) => {\n  console.log(stats?.toJson());\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonbeforestartdevserver",children:["rsbuild.onBeforeStartDevServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonbeforestartdevserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Called before starting the dev server."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnBeforeStartDevServer(\n  callback: (params: {\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onBeforeStartDevServer(() => {\n  console.log('before start!');\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonafterstartdevserver",children:["rsbuild.onAfterStartDevServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonafterstartdevserver",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Called after starting the dev server, you can get the port number with the ",(0,s.jsx)(n.code,{children:"port"})," parameter, and the page routes info with the ",(0,s.jsx)(n.code,{children:"routes"})," parameter."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Routes = Array<{\n  entryName: string;\n  pathname: string;\n}>;\n\nfunction OnAfterStartDevServer(\n  callback: (params: {\n    port: number;\n    routes: Routes;\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onAfterStartDevServer(({ port, routes }) => {\n  console.log('this port is: ', port);\n  console.log('this routes is: ', routes);\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonclosedevserver",children:["rsbuild.onCloseDevServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonclosedevserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Called when close the dev server."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function onCloseDevServer(callback: () => Promise<void> | void): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onCloseDevServer(async () => {\n  console.log('close dev server!');\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonbeforestartprodserver",children:["rsbuild.onBeforeStartProdServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonbeforestartprodserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Called before starting the production preview server."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnBeforeStartProdServer(callback: () => Promise<void> | void): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onBeforeStartProdServer(() => {\n  console.log('before start!');\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonafterstartprodserver",children:["rsbuild.onAfterStartProdServer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonafterstartprodserver",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Called after starting the production preview server, you can get the port number with the ",(0,s.jsx)(n.code,{children:"port"})," parameter, and the page routes info with the ",(0,s.jsx)(n.code,{children:"routes"})," parameter."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Routes = Array<{\n  entryName: string;\n  pathname: string;\n}>;\n\nfunction OnAfterStartProdServer(\n  callback: (params: {\n    port: number;\n    routes: Routes;\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onAfterStartProdServer(({ port, routes }) => {\n  console.log('this port is: ', port);\n  console.log('this routes is: ', routes);\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildondevcompiledone",children:["rsbuild.onDevCompileDone",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildondevcompiledone",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Called after each development mode build, you can use ",(0,s.jsx)(n.code,{children:"isFirstCompile"})," to determine whether it is the first build."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnDevCompileDone(\n  callback: (params: {\n    isFirstCompile: boolean;\n    stats: Stats | MultiStats;\n    environments: Record<string, EnvironmentContext>;\n  }) => Promise<void> | void,\n): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onDevCompileDone(({ isFirstCompile }) => {\n  if (isFirstCompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildonexit",children:["rsbuild.onExit",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildonexit",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Called when the process is going to exit, this hook can only execute synchronous code."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function OnExit(callback: () => void): void;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onExit(() => {\n  console.log('exit!');\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildgetrsbuildconfig",children:["rsbuild.getRsbuildConfig",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildgetrsbuildconfig",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Get the Rsbuild config, this method must be called after the ",(0,s.jsx)(n.code,{children:"modifyRsbuildConfig"})," hook is executed."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type GetRsbuildConfig = {\n  (): Readonly<RsbuildConfig>;\n  (type: 'original' | 'current'): Readonly<RsbuildConfig>;\n  (type: 'normalized'): NormalizedConfig;\n};\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["You can specify the type of Rsbuild config to read by using the ",(0,s.jsx)(n.code,{children:"type"})," parameter:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Get the original Rsbuild config defined by the user.\ngetRsbuildConfig('original');\n\n// Get the current Rsbuild config.\n// The content of this config will change at different execution stages of Rsbuild.\n// For example, the content of the current Rsbuild config will be modified after running the `modifyRsbuildConfig` hook.\ngetRsbuildConfig('current');\n\n// Get the normalized Rsbuild config.\n// This method must be called after the `modifyRsbuildConfig` hook has been executed.\n// It is equivalent to the `getNormalizedConfig` method.\ngetRsbuildConfig('normalized');\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onBeforeBuild(() => {\n  const config = rsbuild.getRsbuildConfig();\n  console.log(config.html?.title);\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rsbuildgetnormalizedconfig",children:["rsbuild.getNormalizedConfig",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuildgetnormalizedconfig",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Get the all normalized Rsbuild config or the Rsbuild config of a specified environment, this method must be called after the ",(0,s.jsx)(n.a,{href:"/plugins/dev/hooks#modifyrsbuildconfig",children:"modifyRsbuildConfig"})," hook is executed."]}),"\n",(0,s.jsxs)(n.p,{children:["Compared with the ",(0,s.jsx)(n.code,{children:"api.getRsbuildConfig"})," method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. For example, the ",(0,s.jsx)(n.code,{children:"undefined"})," type of ",(0,s.jsx)(n.code,{children:"config.html"})," will be removed."]}),"\n",(0,s.jsx)(n.p,{children:"It is recommended to use this method to get the Rsbuild config."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Type:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"/** Get the Rsbuild configuration of the specified environment */\nfunction GetNormalizedConfig(options: {\n  environment: string;\n}): Readonly<NormalizedEnvironmentConfig>;\n\n/** Get all Rsbuild configurations */\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"rsbuild.onBeforeBuild(() => {\n  const config = api.getNormalizedConfig();\n  console.log(config.html.title);\n});\n"})})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}let o=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["en%2Fapi%2Fjavascript-api%2Finstance.mdx"]={toc:[{text:"rsbuild.context",id:"rsbuildcontext",depth:2},{text:"context.version",id:"contextversion",depth:3},{text:"context.rootPath",id:"contextrootpath",depth:3},{text:"context.distPath",id:"contextdistpath",depth:3},{text:"context.cachePath",id:"contextcachepath",depth:3},{text:"context.devServer",id:"contextdevserver",depth:3},{text:"context.bundlerType",id:"contextbundlertype",depth:3},{text:"rsbuild.build",id:"rsbuildbuild",depth:2},{text:"Monitor file changes",id:"monitor-file-changes",depth:3},{text:"Stats Object",id:"stats-object",depth:3},{text:"Custom Compiler",id:"custom-compiler",depth:3},{text:"rsbuild.startDevServer",id:"rsbuildstartdevserver",depth:2},{text:"Custom Compiler",id:"custom-compiler-1",depth:3},{text:"Get Port Silently",id:"get-port-silently",depth:3},{text:"rsbuild.createDevServer",id:"rsbuildcreatedevserver",depth:2},{text:"connectWebSocket",id:"connectwebsocket",depth:3},{text:"rsbuild.preview",id:"rsbuildpreview",depth:2},{text:"rsbuild.createCompiler",id:"rsbuildcreatecompiler",depth:2},{text:"rsbuild.addPlugins",id:"rsbuildaddplugins",depth:2},{text:"rsbuild.getPlugins",id:"rsbuildgetplugins",depth:2},{text:"rsbuild.removePlugins",id:"rsbuildremoveplugins",depth:2},{text:"rsbuild.isPluginExists",id:"rsbuildispluginexists",depth:2},{text:"rsbuild.initConfigs",id:"rsbuildinitconfigs",depth:2},{text:"rsbuild.inspectConfig",id:"rsbuildinspectconfig",depth:2},{text:"Example",id:"example",depth:3},{text:"Output Path",id:"output-path",depth:3},{text:"rsbuild.onBeforeCreateCompiler",id:"rsbuildonbeforecreatecompiler",depth:2},{text:"rsbuild.onAfterCreateCompiler",id:"rsbuildonaftercreatecompiler",depth:2},{text:"rsbuild.onBeforeBuild",id:"rsbuildonbeforebuild",depth:2},{text:"rsbuild.onAfterBuild",id:"rsbuildonafterbuild",depth:2},{text:"rsbuild.onBeforeStartDevServer",id:"rsbuildonbeforestartdevserver",depth:2},{text:"rsbuild.onAfterStartDevServer",id:"rsbuildonafterstartdevserver",depth:2},{text:"rsbuild.onCloseDevServer",id:"rsbuildonclosedevserver",depth:2},{text:"rsbuild.onBeforeStartProdServer",id:"rsbuildonbeforestartprodserver",depth:2},{text:"rsbuild.onAfterStartProdServer",id:"rsbuildonafterstartprodserver",depth:2},{text:"rsbuild.onDevCompileDone",id:"rsbuildondevcompiledone",depth:2},{text:"rsbuild.onExit",id:"rsbuildonexit",depth:2},{text:"rsbuild.getRsbuildConfig",id:"rsbuildgetrsbuildconfig",depth:2},{text:"rsbuild.getNormalizedConfig",id:"rsbuildgetnormalizedconfig",depth:2}],title:"Rsbuild Instance",frontmatter:{}}}}]);